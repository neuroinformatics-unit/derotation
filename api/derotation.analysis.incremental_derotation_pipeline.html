
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>derotation.analysis.incremental_derotation_pipeline &#8212; Derotation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=8d03875c" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=360bc84d"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/derotation.analysis.incremental_derotation_pipeline';</script>
    <link rel="canonical" href="https://derotation.neuroinformatics.dev/api/derotation.analysis.incremental_derotation_pipeline.html" />
    <link rel="icon" href="../_static/light-logo-niu.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="derotation.analysis.mean_images" href="derotation.analysis.mean_images.html" />
    <link rel="prev" title="derotation.analysis.full_derotation_pipeline" href="derotation.analysis.full_derotation_pipeline.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">derotation v0.1.3</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing.html">
    Contributing Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../api_index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/neuroinformatics-unit/derotation" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://neuroinformatics.zulipchat.com/#narrow/channel/495735-Derotation" title="Zulip (chat)" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-comments fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Zulip (chat)</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing.html">
    Contributing Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../api_index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/neuroinformatics-unit/derotation" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://neuroinformatics.zulipchat.com/#narrow/channel/495735-Derotation" title="Zulip (chat)" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-comments fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Zulip (chat)</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="derotation.analysis.bayesian_optimization.html">derotation.analysis.bayesian_optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="derotation.analysis.blob_detection.html">derotation.analysis.blob_detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="derotation.analysis.fit_ellipse.html">derotation.analysis.fit_ellipse</a></li>
<li class="toctree-l1"><a class="reference internal" href="derotation.analysis.full_derotation_pipeline.html">derotation.analysis.full_derotation_pipeline</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">derotation.analysis.incremental_derotation_pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="derotation.analysis.mean_images.html">derotation.analysis.mean_images</a></li>
<li class="toctree-l1"><a class="reference internal" href="derotation.analysis.metrics.html">derotation.analysis.metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="derotation.config.load_config.html">derotation.config.load_config</a></li>
<li class="toctree-l1"><a class="reference internal" href="derotation.derotate_batch.html">derotation.derotate_batch</a></li>
<li class="toctree-l1"><a class="reference internal" href="derotation.derotate_by_line.html">derotation.derotate_by_line</a></li>
<li class="toctree-l1"><a class="reference internal" href="derotation.load_data.custom_data_loaders.html">derotation.load_data.custom_data_loaders</a></li>
<li class="toctree-l1"><a class="reference internal" href="derotation.plotting_hooks.for_derotation.html">derotation.plotting_hooks.for_derotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="derotation.simulate.line_scanning_microscope.html">derotation.simulate.line_scanning_microscope</a></li>
<li class="toctree-l1"><a class="reference internal" href="derotation.simulate.synthetic_data.html">derotation.simulate.synthetic_data</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../api_index.html" class="nav-link">API Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">derotation.analysis.incremental_derotation_pipeline</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-derotation.analysis.incremental_derotation_pipeline">
<span id="derotation-analysis-incremental-derotation-pipeline"></span><h1>derotation.analysis.incremental_derotation_pipeline<a class="headerlink" href="#module-derotation.analysis.incremental_derotation_pipeline" title="Link to this heading">#</a></h1>
<p>This module contains the <code class="docutils literal notranslate"><span class="pre">IncrementalPipeline</span></code> class, which is a child of
the <code class="docutils literal notranslate"><span class="pre">FullPipeline</span></code> class. It is used to derotate the image stack that was
acquired using the incremental rotation method. The class inherits all the
attributes and methods from the <code class="docutils literal notranslate"><span class="pre">FullPipeline</span></code> class and adds additional
logic to register the images.
Methods that are not overwritten from the parent class are not documented
here.</p>
<p class="rubric">Classes</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline" title="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IncrementalPipeline</span></code></a>(*args, **kwargs)</p></td>
<td><p>Derotate the image stack that was acquired using the incremental rotation method.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">derotation.analysis.incremental_derotation_pipeline.</span></span><span class="sig-name descname"><span class="pre">IncrementalPipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/derotation/analysis/incremental_derotation_pipeline.html#IncrementalPipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline" title="Link to this definition">#</a></dt>
<dd><p>Derotate the image stack that was acquired using the incremental
rotation method.</p>
<p>As a child of <code class="docutils literal notranslate"><span class="pre">FullPipeline</span></code>, it inherits all the attributes and
methods from it and adds additional logic to register the images.
Here in the constructor we specify the degrees for each incremental
rotation and the number of rotations.</p>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>()</p></td>
<td><p>Overwrite the <code class="docutils literal notranslate"><span class="pre">__call__</span></code> method from the parent class to derotate the image stack acquired using the incremental rotation method.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_circle_mask</span></code>(image_stack[, diameter])</p></td>
<td><p>Adds a circular mask to the rotated image stack.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.adjust_rotation_increment" title="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.adjust_rotation_increment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">adjust_rotation_increment</span></code></a>()</p></td>
<td><p>Overwrite the method from the parent class to adjust the rotation increment and the number of ticks per rotation.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_angles_by_line_and_frame</span></code>()</p></td>
<td><p>From the interpolated angles, it calculates the rotation angles by line and frame.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_velocity</span></code>()</p></td>
<td><p>Calculates the velocity of the rotation by line.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.check_number_of_frame_angles" title="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.check_number_of_frame_angles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_number_of_frame_angles</span></code></a>()</p></td>
<td><p>Check if the number of rotation angles by frame is equal to the number of frames in the image stack.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_number_of_rotations</span></code>()</p></td>
<td><p>Checks that the number of rotations is as expected.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.check_rotation_number" title="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.check_rotation_number"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_rotation_number</span></code></a>(start, end)</p></td>
<td><p>Checks that the number of rotations is as expected.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.check_rotation_number_after_interpolation" title="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.check_rotation_number_after_interpolation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_rotation_number_after_interpolation</span></code></a>(...)</p></td>
<td><p>Checks that the number of rotations is as expected.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">clock_to_latest_frame_start</span></code>(clock_time)</p></td>
<td><p>Get the index of the frame that is being acquired at the given clock time.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">clock_to_latest_line_start</span></code>(clock_time)</p></td>
<td><p>Get the index of the line that is being scanned at the given clock time.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">clock_to_latest_rotation_start</span></code>(clock_time)</p></td>
<td><p>Get the index of the latest rotation that happened.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">correct_start_and_end_rotation_signal</span></code>(start, end)</p></td>
<td><p>Removes artifacts from the start and end times of the on periods of the rotation signal.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.create_signed_rotation_array" title="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.create_signed_rotation_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_signed_rotation_array</span></code></a>()</p></td>
<td><p>Reconstructs an array that has the same length as the full rotation signal.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">derotate_frames_line_by_line</span></code>()</p></td>
<td><p>Wrapper for the function <code class="docutils literal notranslate"><span class="pre">derotate_an_image_array_line_by_line</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_ticks_outside_of_rotation</span></code>()</p></td>
<td><p>Drops the rotation ticks that are outside of the rotation periods.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.find_center_of_rotation" title="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.find_center_of_rotation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_center_of_rotation</span></code></a>()</p></td>
<td><p>Find the center of rotation by fitting an ellipse to the largest blob centers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_image_offset</span></code>(img)</p></td>
<td><p>Find the &quot;F0&quot;, also called &quot;image offset&quot; for a given image.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_missing_rotation_on_periods</span></code>()</p></td>
<td><p>Find the missing rotation on periods by looking at the rotation ticks and the rotation on signal.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_optimal_parameters</span></code>()</p></td>
<td><p>Finds the optimal parameters for the derotation.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_rotation_peaks</span></code>()</p></td>
<td><p>Finds the peaks of the rotation ticks signal using scipy.signal.find_peaks.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_config</span></code>(config_name)</p></td>
<td><p>Loads config file from derotation/config folder.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.get_interpolated_angles" title="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.get_interpolated_angles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_interpolated_angles</span></code></a>()</p></td>
<td><p>Overwrite the method from the parent class to interpolate the angles.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_peaks_in_rotation</span></code>(start, end)</p></td>
<td><p>Counts the number of ticks in a rotation given the start and end times of the rotation.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_start_end_times_with_threshold</span></code>(signal, ...)</p></td>
<td><p>Finds the start and end times of the on periods of the signal.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.is_number_of_ticks_correct" title="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.is_number_of_ticks_correct"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_number_of_ticks_correct</span></code></a>()</p></td>
<td><p>Overwrite the method from the parent class to check if the number of ticks is as expected.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_data</span></code>()</p></td>
<td><p>Loads data from the paths specified in the config file.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mean_image_for_each_rotation</span></code>(...)</p></td>
<td><p>Calculates the mean image for each rotation and saves it in the <code class="docutils literal notranslate"><span class="pre">debug_plots</span></code> folder.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_max_projection_with_center</span></code>(stack[, name])</p></td>
<td><p>Plots the maximum projection of the image stack with the center of rotation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.plot_rotation_angles_and_velocity" title="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.plot_rotation_angles_and_velocity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_rotation_angles_and_velocity</span></code></a>()</p></td>
<td><p>Plots example rotation angles by line and frame for each speed.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_rotation_on_and_ticks</span></code>()</p></td>
<td><p>Plots the rotation ticks and the rotation on signal.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.plot_rotation_speeds" title="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.plot_rotation_speeds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_rotation_speeds</span></code></a>()</p></td>
<td><p>Plots the velocity of the rotation for each speed.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">process_analog_signals</span></code>()</p></td>
<td><p>From the analog signals (frame clock, line clock, full rotation, rotation ticks) calculates the rotation angles by line and frame.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_artifacts_from_interpolated_angles</span></code>()</p></td>
<td><p>Removes artifacts from the interpolated angles, coming from an inconsistency between the number of ticks and cumulative sum.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(masked)</p></td>
<td><p>Saves the masked image stack in the saving folder specified in the config file.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_csv_with_derotation_data</span></code>()</p></td>
<td><p>Saves a csv file with the rotation angles by line and frame, and the rotation on signal.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_optimal_center</span></code>()</p></td>
<td><p>Checks if the optimal center of rotation is calculated.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">start_logging</span></code>()</p></td>
<td><p>Starts logging process using fancylog package.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.create_signed_rotation_array">
<span class="sig-name descname"><span class="pre">create_signed_rotation_array</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/derotation/analysis/incremental_derotation_pipeline.html#IncrementalPipeline.create_signed_rotation_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.create_signed_rotation_array" title="Link to this definition">#</a></dt>
<dd><p>Reconstructs an array that has the same length as the full rotation
signal. It is 0 when the motor is off, and it is 1 or -1 when the motor
is on, depending on the direction of rotation. 1 is clockwise, -1 is
counter clockwise.
Uses the start and end times of the on periods of rotation signal, and
the direction of rotation to reconstruct the array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The rotation on signal.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.is_number_of_ticks_correct">
<span class="sig-name descname"><span class="pre">is_number_of_ticks_correct</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/derotation/analysis/incremental_derotation_pipeline.html#IncrementalPipeline.is_number_of_ticks_correct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.is_number_of_ticks_correct" title="Link to this definition">#</a></dt>
<dd><p>Overwrite the method from the parent class to check if the number
of ticks is as expected.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the number of ticks is as expected, False otherwise.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.adjust_rotation_increment">
<span class="sig-name descname"><span class="pre">adjust_rotation_increment</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/derotation/analysis/incremental_derotation_pipeline.html#IncrementalPipeline.adjust_rotation_increment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.adjust_rotation_increment" title="Link to this definition">#</a></dt>
<dd><p>Overwrite the method from the parent class to adjust the rotation
increment and the number of ticks per rotation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The new rotation increment and the number of ticks per rotation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.get_interpolated_angles">
<span class="sig-name descname"><span class="pre">get_interpolated_angles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/derotation/analysis/incremental_derotation_pipeline.html#IncrementalPipeline.get_interpolated_angles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.get_interpolated_angles" title="Link to this definition">#</a></dt>
<dd><p>Overwrite the method from the parent class to interpolate the
angles.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The interpolated angles.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.check_rotation_number_after_interpolation">
<span class="sig-name descname"><span class="pre">check_rotation_number_after_interpolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/derotation/analysis/incremental_derotation_pipeline.html#IncrementalPipeline.check_rotation_number_after_interpolation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.check_rotation_number_after_interpolation" title="Link to this definition">#</a></dt>
<dd><p>Checks that the number of rotations is as expected.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – if the number of start and end of rotations is different</p></li>
<li><p><strong>ValueError</strong> – if the number of rotations is not as expected</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.check_number_of_frame_angles">
<span class="sig-name descname"><span class="pre">check_number_of_frame_angles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/derotation/analysis/incremental_derotation_pipeline.html#IncrementalPipeline.check_number_of_frame_angles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.check_number_of_frame_angles" title="Link to this definition">#</a></dt>
<dd><p>Check if the number of rotation angles by frame is equal to the
number of frames in the image stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – if the number of rotation angles by frame is not equal to the
number of frames in the image stack.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.check_rotation_number">
<span class="sig-name descname"><span class="pre">check_rotation_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/derotation/analysis/incremental_derotation_pipeline.html#IncrementalPipeline.check_rotation_number"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.check_rotation_number" title="Link to this definition">#</a></dt>
<dd><p>Checks that the number of rotations is as expected.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – if the number of start and end of rotations is different</p></li>
<li><p><strong>ValueError</strong> – if the number of rotations is not as expected</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.plot_rotation_angles_and_velocity">
<span class="sig-name descname"><span class="pre">plot_rotation_angles_and_velocity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/derotation/analysis/incremental_derotation_pipeline.html#IncrementalPipeline.plot_rotation_angles_and_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.plot_rotation_angles_and_velocity" title="Link to this definition">#</a></dt>
<dd><p>Plots example rotation angles by line and frame for each speed.
This plot will be saved in the <code class="docutils literal notranslate"><span class="pre">debug_plots</span></code> folder.
Please inspect it to check that the rotation angles are correctly
calculated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.plot_rotation_speeds">
<span class="sig-name descname"><span class="pre">plot_rotation_speeds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/derotation/analysis/incremental_derotation_pipeline.html#IncrementalPipeline.plot_rotation_speeds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.plot_rotation_speeds" title="Link to this definition">#</a></dt>
<dd><p>Plots the velocity of the rotation for each speed.
This plot will be saved in the <code class="docutils literal notranslate"><span class="pre">debug_plots</span></code> folder.
Please inspect it to check that the velocity is correctly calculated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.find_center_of_rotation">
<span class="sig-name descname"><span class="pre">find_center_of_rotation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/derotation/analysis/incremental_derotation_pipeline.html#IncrementalPipeline.find_center_of_rotation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.find_center_of_rotation" title="Link to this definition">#</a></dt>
<dd><p>Find the center of rotation by fitting an ellipse to the largest
blob centers.</p>
<p>Step 1: Calculate the mean images for each rotation increment.
Step 2: Find the blobs in the mean images.
Step 3: Fit an ellipse to the largest blob centers and get its center.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The coordinates center of rotation (x, y).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[int, int]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="derotation.analysis.full_derotation_pipeline.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">derotation.analysis.full_derotation_pipeline</p>
      </div>
    </a>
    <a class="right-next"
       href="derotation.analysis.mean_images.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">derotation.analysis.mean_images</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline"><code class="docutils literal notranslate"><span class="pre">IncrementalPipeline</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.create_signed_rotation_array"><code class="docutils literal notranslate"><span class="pre">IncrementalPipeline.create_signed_rotation_array()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.is_number_of_ticks_correct"><code class="docutils literal notranslate"><span class="pre">IncrementalPipeline.is_number_of_ticks_correct()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.adjust_rotation_increment"><code class="docutils literal notranslate"><span class="pre">IncrementalPipeline.adjust_rotation_increment()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.get_interpolated_angles"><code class="docutils literal notranslate"><span class="pre">IncrementalPipeline.get_interpolated_angles()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.check_rotation_number_after_interpolation"><code class="docutils literal notranslate"><span class="pre">IncrementalPipeline.check_rotation_number_after_interpolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.check_number_of_frame_angles"><code class="docutils literal notranslate"><span class="pre">IncrementalPipeline.check_number_of_frame_angles()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.check_rotation_number"><code class="docutils literal notranslate"><span class="pre">IncrementalPipeline.check_rotation_number()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.plot_rotation_angles_and_velocity"><code class="docutils literal notranslate"><span class="pre">IncrementalPipeline.plot_rotation_angles_and_velocity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.plot_rotation_speeds"><code class="docutils literal notranslate"><span class="pre">IncrementalPipeline.plot_rotation_speeds()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derotation.analysis.incremental_derotation_pipeline.IncrementalPipeline.find_center_of_rotation"><code class="docutils literal notranslate"><span class="pre">IncrementalPipeline.find_center_of_rotation()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item"><p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
    </p>
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a>
    0.16.1.
    </p></div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><div class="things-in-a-row">
    <a href="https://neuroinformatics.dev/">
        <img src="../_static/light-logo-niu.png" alt="NIU" class="only-light img-sponsor"/>
        <img src="../_static/dark-logo-niu.png" alt="NIU" class="only-dark img-sponsor"/>
    </a>
    <a href="https://www.sainsburywellcome.org/web/">
        <img src="../_static/light-logo-swc.png" alt="SWC" class="only-light img-sponsor"/>
        <img src="../_static/dark-logo-swc.png" alt="SWC" class="only-dark img-sponsor"/>
    </a>
    <a href="https://www.ucl.ac.uk/">
        <img src="../_static/light-logo-ucl.png" alt="UCL" class="only-light img-sponsor"/>
        <img src="../_static/dark-logo-ucl.png" alt="UCL" class="only-dark img-sponsor"/>
    </a>
</div></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>